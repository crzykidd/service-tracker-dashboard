<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Service Entry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .bg-dashboard-dark { background-color: #1a202c; }
        .bg-dashboard-card { background-color: #2d3748; }
        .bg-dashboard-info-box { background-color: #252f3e; }
        .text-dashboard-primary { color: #e2e8f0; }
        .text-dashboard-secondary { color: #a0aec0; }
        .border-dashboard-accent { border-color: #4a5568; }
        .btn-primary { background-color: #4299e1; color: white; }
        .btn-primary:hover { background-color: #3182ce; }
        .btn-secondary { background-color: #4a5568; color: white; }
        .btn-secondary:hover { background-color: #2d3748; }
        .form-input {
            background-color: #1a202c;
            border-color: #4a5568;
            color: #e2e8f0;
        }
        .form-input:focus {
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
            outline: none;
        }
        .form-checkbox { color: #4299e1; }
        .info-field-label {
            font-weight: 500;
            color: #cbd5e0;
            min-width: 200px;
            display: inline-block;
        }
        .info-field-value {
            color: #e2e8f0;
            word-break: break-all;
        }
    </style>
</head>
<body class="bg-dashboard-dark text-dashboard-primary flex items-center justify-center min-h-screen p-4 sm:p-6">
    <div class="w-full max-w-2xl">
        <div class="w-full max-w-4xl flex justify-end gap-2 mb-4">
            <a href="/tiled_dash" class="border border-gray-500 text-gray-300 text-sm px-2 py-0.5 rounded hover:bg-gray-600 hover:text-white transition">Tile View</a>
            <a href="/" class="border border-gray-500 text-gray-300 text-sm px-2 py-0.5 rounded hover:bg-gray-600 hover:text-white transition">Dashboard</a>
            <a href="/add" class="border border-gray-500 text-gray-300 text-sm px-2 py-0.5 rounded hover:bg-gray-600 hover:text-white transition">Add Record</a>
        </div>

        <div class="bg-dashboard-card shadow-2xl rounded-xl p-6 sm:p-8 md:p-10 mb-6">
            <h1 class="text-2xl sm:text-3xl font-bold text-center mb-6 sm:mb-8">Edit Service Entry</h1>
            <form action="{{ url_for('edit_entry', id=entry.id, ref=ref) }}" method="POST">
                <input type="hidden" name="force_update_icon" value="true">

                <div class="mb-5">
                    <label for="host" class="block text-sm font-medium text-dashboard-secondary mb-1">Host</label>
                    <input type="text" name="host" id="host" class="form-input w-full px-4 py-2.5 rounded-lg text-sm focus:ring-2 focus:ring-blue-500" value="{{ entry.host }}">
                </div>

                <div class="mb-5">
                    <label for="application" class="block text-sm font-medium text-dashboard-secondary mb-1">Application (Container Name)</label>
                    <input type="text" name="container_name" id="application" class="form-input w-full px-4 py-2.5 rounded-lg text-sm focus:ring-2 focus:ring-blue-500" value="{{ entry.container_name }}">
                </div>

                <div class="mb-5">
                    <label for="internal_url" class="block text-sm font-medium text-dashboard-secondary mb-1">Internal URL</label>
                    <div class="flex items-center space-x-3">
                        <input type="url" name="internalurl" id="internal_url" class="form-input flex-grow px-4 py-2.5 rounded-lg text-sm focus:ring-2 focus:ring-blue-500" value="{{ entry.internalurl or '' }}">
                        <div class="flex items-center">
                            <input type="checkbox" name="internal_health_check_enabled" id="internal_health_check" class="form-checkbox h-5 w-5 rounded border-dashboard-accent focus:ring-blue-500" {% if entry.internal_health_check_enabled %}checked{% endif %}>
                            <label for="internal_health_check" class="ml-2 text-sm text-dashboard-secondary">Health Check</label>
                        </div>
                    </div>
                </div>

                <div class="mb-5">
                    <label for="external_url" class="block text-sm font-medium text-dashboard-secondary mb-1">External URL</label>
                    <div class="flex items-center space-x-3">
                        <input type="url" name="externalurl" id="external_url" class="form-input flex-grow px-4 py-2.5 rounded-lg text-sm focus:ring-2 focus:ring-blue-500" value="{{ entry.externalurl or '' }}">
                        <div class="flex items-center">
                            <input type="checkbox" name="external_health_check_enabled" id="external_health_check" class="form-checkbox h-5 w-5 rounded border-dashboard-accent focus:ring-blue-500" {% if entry.external_health_check_enabled %}checked{% endif %}>
                            <label for="external_health_check" class="ml-2 text-sm text-dashboard-secondary">Health Check</label>
                        </div>
                    </div>
                </div>

                <div class="mb-5">
                    <label for="group_name" class="block text-sm font-medium text-dashboard-secondary mb-1">Group Name</label>
                    <input type="text" name="group_name" id="group_name" class="form-input w-full px-4 py-2.5 rounded-lg text-sm focus:ring-2 focus:ring-blue-500" value="{{ entry.group_name or '' }}">
                </div>

                <div class="mb-5">
                    <label for="icon_image" class="block text-sm font-medium text-dashboard-secondary mb-1">Icon Image</label>
                    <input type="text" name="image_icon" id="icon_image" class="form-input w-full px-4 py-2.5 rounded-lg text-sm focus:ring-2 focus:ring-blue-500" value="{{ entry.image_icon or '' }}">
                    <p class="mt-1 text-xs text-dashboard-secondary">Enter the filename of the SVG icon (e.g., service.svg).</p>
                    <p class="mt-1 text-xs text-dashboard-secondary">(will try to match automatically from application above.)</p>
                </div>

                <div class="mb-6 sm:mb-8">
                    <div class="flex items-center">
                        <input type="checkbox" name="is_static" id="locked" class="form-checkbox h-5 w-5 rounded border-dashboard-accent focus:ring-blue-500" {% if entry.is_static %}checked{% endif %}>
                        <label for="locked" class="ml-2 text-sm font-medium text-dashboard-secondary">Locked (Static Entry)</label>
                    </div>
                    <p class="mt-1 text-xs text-dashboard-secondary">If checked, this entry will not be updated by automated API calls.</p>
                </div>

                <div class="flex flex-col sm:flex-row sm:justify-end space-y-3 sm:space-y-0 sm:space-x-4">
                    <button type="submit" class="btn-primary w-full sm:w-auto px-6 py-2.5 rounded-lg font-medium text-sm transition duration-150 ease-in-out">Update Entry</button>
                    <button type="button" onclick="window.history.back();" class="btn-secondary w-full sm:w-auto px-6 py-2.5 rounded-lg font-medium text-sm transition duration-150 ease-in-out">Cancel</button>
                </div>
                               <hr class="my-6 border-dashboard-accent">
              <div class="mt-6 bg-dashboard-info-box rounded-lg p-4">
                <h2 class="text-lg font-semibold text-red-400 mb-3">Danger Zone</h2>
                <p class="text-sm text-dashboard-secondary mb-2">Deleting this entry is permanent and cannot be undone.</p>
                <label for="delete_confirmation" class="block text-sm font-medium text-dashboard-secondary mb-1">
                    Type <strong>{{ entry.container_name }}</strong> to confirm deletion:
                </label>
                <div class="flex flex-col sm:flex-row sm:items-center sm:space-x-4">
                    <input type="text" name="delete_confirmation" id="delete_confirmation"
                          placeholder="Type container name to confirm" 
                          class="form-input w-full sm:w-auto px-4 py-2 rounded-lg text-sm">
                    <button type="submit" name="delete" value="true"
                            class="btn-secondary bg-red-600 hover:bg-red-700 w-full sm:w-auto px-6 py-2.5 rounded-lg font-medium text-sm transition duration-150 ease-in-out">
                        Delete Entry
                    </button>
                </div>
            </div>
            </form>
        </div>

        <div class="bg-dashboard-info-box shadow-xl rounded-xl p-6 sm:p-8">
            <h2 class="text-xl sm:text-2xl font-semibold mb-4 sm:mb-6 text-dashboard-primary">Additional Information</h2>
            <div class="space-y-4">
                <div><span class="info-field-label">Entry ID:</span><span class="info-field-value ml-2">{{ entry.id }}</span></div>
                <div><span class="info-field-label">Container ID:</span><span class="info-field-value ml-2">{{ entry.container_id }}</span></div>
                <div><span class="info-field-label">Stack Name:</span><span class="info-field-value ml-2">{{ entry.stack_name }}</span></div>
                <div><span class="info-field-label">Docker Status:</span><span class="info-field-value ml-2">{{ entry.docker_status }}</span></div>
                <div><span class="info-field-label">Started At:</span><span class="info-field-value ml-2">{{ entry.started_at }}</span></div>
                <div><span class="info-field-label">Last Updated:</span><span class="info-field-value ml-2">{{ entry.last_updated }}</span></div>
                <div><span class="info-field-label">Last API Update:</span><span class="info-field-value ml-2">{{ entry.last_api_update }}</span></div>
                <div><span class="info-field-label">Internal Health Status:</span><span class="info-field-value ml-2">{{ entry.internal_health_status }}</span></div>
                <div><span class="info-field-label">Internal Health Last Check:</span><span class="info-field-value ml-2">{{ entry.internal_health_update }}</span></div>
                <div><span class="info-field-label">External Health Status:</span><span class="info-field-value ml-2">{{ entry.external_health_status }}</span></div>
                <div><span class="info-field-label">External Health Last Check:</span><span class="info-field-value ml-2">{{ entry.external_health_update }}</span></div>
                <div><span class="info-field-label">Image Registry:</span><span class="info-field-value ml-2">{{ entry.image_registry }}</span></div>
                <div><span class="info-field-label">Image Owner:</span><span class="info-field-value ml-2">{{ entry.image_owner }}</span></div>
                <div><span class="info-field-label">Image Name:</span><span class="info-field-value ml-2">{{ entry.image_name }}</span></div>
                <div><span class="info-field-label">Image Tag:</span><span class="info-field-value ml-2">{{ entry.image_tag }}</span></div>
            </div>
        </div>
    </div>
</body>
</html>
